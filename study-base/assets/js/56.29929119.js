(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{250:function(s,t,n){"use strict";n.r(t);var a=n(6),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"项目部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#项目部署"}},[s._v("#")]),s._v(" 项目部署")]),s._v(" "),n("h2",{attrs:{id:"手动部署项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#手动部署项目"}},[s._v("#")]),s._v(" 手动部署项目")]),s._v(" "),n("ul",[n("li",[s._v("首先要部署环境\n"),n("ul",[n("li",[s._v("升级系统软件包\n"),n("code",[s._v("yum -y update")])])])])]),s._v(" "),n("h3",{attrs:{id:"安装mysql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装mysql"}},[s._v("#")]),s._v(" 安装mysql")]),s._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql57-community-release-el7-9.noarch.rpm\nyum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y mysql-server\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动mysql")]),s._v("\nsystemctl start mysqld\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试mysql")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取临时密码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'temporary password'")]),s._v(" /var/log/mysqld.log\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过临时密码登录")]),s._v("\nmysql -u root -p\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改mysql密码")]),s._v("\nALTER "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),s._v(" IDENTIFIED BY "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'www.IT666.com'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认密码的长度最小值为 4 ，由 大/小写字母各一个 + 阿拉伯数字一个 + 特殊字符一个")]),s._v("\n- 设置允许远程链接\nuse mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nupdate user "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" where user "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nFLUSH PRIVILEGES"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意: mysql8导出的数据想要导入到低版本的mysql中需要修改")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# utf8mb4替换为utf8")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# utf8mb4_0900_ai_ci替换为utf8_general_ci")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# utf8_croatian_ci替换为utf8_general_ci")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# utf8mb4_general_ci替换为utf8_general_ci")]),s._v("\n\n")])])]),n("h3",{attrs:{id:"安装redis"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装redis"}},[s._v("#")]),s._v(" 安装redis")]),s._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装redis相关依赖")]),s._v("\nyum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y gcc\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装redis")]),s._v("\nyum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y redis\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改redis配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ql redis\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/redis.conf\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动redis")]),s._v("\nsystemctl start redis\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试redis")]),s._v("\nredis-cli -h "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("118.25")]),s._v(".146.88 -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n\n")])])]),n("h3",{attrs:{id:"安装nvm"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装nvm"}},[s._v("#")]),s._v(" 安装nvm")]),s._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("\nyum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" --version\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone git://github.com/creationix/nvm.git ~/nvm\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" -v nvm\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"source ~/nvm/nvm.sh"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ~/.bashrc\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/.bashrc\n\n")])])]),n("h3",{attrs:{id:"安装nodejs"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装nodejs"}},[s._v("#")]),s._v(" 安装nodeJs")]),s._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("\nnvm "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" v12.19.0\n\n")])])]),n("h3",{attrs:{id:"安装nrm"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装nrm"}},[s._v("#")]),s._v(" 安装nrm")]),s._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -g nrm\nnrm "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\nnrm use taobao\n\n")])])]),n("h3",{attrs:{id:"部署egg项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#部署egg项目"}},[s._v("#")]),s._v(" 部署egg项目")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://eggjs.org/zh-cn/core/deployment.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("项目部署"),n("OutboundLink")],1)]),s._v(" "),n("ul",[n("li",[s._v("修改"),n("code",[s._v("config.prod.ts")])])]),s._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 增加一个")]),s._v("\nconfig"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("listen "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    port"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7001")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    hostname"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'118.25.146.88'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])])]),n("ul",[n("li",[s._v("修改"),n("code",[s._v(".eslintrc")]),s._v(" 解决 导入使用了"),n("code",[s._v("require")]),s._v("的方式")])]),s._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"rules"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"@typescript-eslint/no-var-requires"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])])]),n("ul",[n("li",[n("p",[s._v("修改"),n("code",[s._v("pageck.json")]),s._v(" "),n("code",[s._v('"lint": "eslint --fix . --ext .ts",')])])]),s._v(" "),n("li",[n("p",[s._v("检查代码,并生成js文件")]),s._v(" "),n("ul",[n("li",[s._v("执行 "),n("code",[s._v("npm run lint")])]),s._v(" "),n("li",[s._v("执行 "),n("code",[s._v("npm run tsc")])])])]),s._v(" "),n("li",[n("p",[s._v("删除"),n("code",[s._v("node_modules")])])]),s._v(" "),n("li",[n("p",[s._v("上传项目到服务器")])]),s._v(" "),n("li",[n("p",[s._v("执行 "),n("code",[s._v("npm install --production")])]),s._v(" "),n("ul",[n("li",[s._v("执行 "),n("code",[s._v("npm run start")])])])]),s._v(" "),n("li",[n("p",[s._v("测试部署")])])]),s._v(" "),n("h2",{attrs:{id:"前端部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前端部署"}},[s._v("#")]),s._v(" 前端部署")]),s._v(" "),n("h3",{attrs:{id:"安装nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装nginx"}},[s._v("#")]),s._v(" 安装nginx")]),s._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("\nyum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y nginx\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改nginx配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/nginx\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" nginx.conf\nuser root\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动nginx")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx start\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置分离路径")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/mginx\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" nginx.conf\ninclude /etc/nginx/conf.d/*.conf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新建配置文件")]),s._v("\n\nserver "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen       "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8090")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server_name  pro_ms_fg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        root /var/www/pro_ms_fg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        index index.html index.htm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启nginx")]),s._v("\nnginx -s reload\n\n")])])]),n("h3",{attrs:{id:"前端项目打包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前端项目打包"}},[s._v("#")]),s._v(" 前端项目打包")]),s._v(" "),n("p",[s._v("环境变量配置")]),s._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("extend"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"umi-request"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在utils/request.ts中配置如下")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" path "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://127.0.0.1:7002'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NODE_ENV")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'development'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    path "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://线上环境地址'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BASE_PATH")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" request "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("extend")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    prefix"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/api/v1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    timeout"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    credentials"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'include'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" request"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n")])])]),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run build\n\n")])])]),n("p",[n("a",{attrs:{href:"https://beta-pro.ant.design/docs/build-cn",target:"_blank",rel:"noopener noreferrer"}},[s._v("项目部署地址"),n("OutboundLink")],1)]),s._v(" "),n("ul",[n("li",[s._v("分析构建文件体积")])]),s._v(" "),n("p",[s._v("如果你的构建文件很大，你可以通过 analyze 命令构建并分析依赖模块的体积分布，从而优化你的代码。")]),s._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run analyze\n\n")])])]),n("p",[s._v("上面的命令会自动在浏览器打开显示体积分布数据的网页。")]),s._v(" "),n("h3",{attrs:{id:"跨域配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#跨域配置"}},[s._v("#")]),s._v(" 跨域配置")]),s._v(" "),n("div",{staticClass:"language-nginx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-nginx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("api "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_pass")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("http")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("118.25")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v(".146")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v(".88")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7001")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("proxy_set_header")]),s._v(" Host "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$host")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])])]),n("h2",{attrs:{id:"自动部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#自动部署"}},[s._v("#")]),s._v(" 自动部署")]),s._v(" "),n("h3",{attrs:{id:"jenkenis"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#jenkenis"}},[s._v("#")]),s._v(" jenkenis")]),s._v(" "),n("p",[s._v("JenKins是开源CI(持续集成)&CD(持续交付)软件领导者，\n提供超过1000个插件来支持构建、部署、自动化，满足任何项目的需求")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.jenkins.io/zh",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.jenkins.io/zh"),n("OutboundLink")],1)]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.redhat.com/zh/topics/devops/what-is-ci-cd",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.redhat.com/zh/topics/devops/what-is-ci-cd"),n("OutboundLink")],1)]),s._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("\n本地代码 ---\x3e  git服务器   \n---\x3e  自动化下载到 ----\x3e JenKins服务器，自动部署  \n----\x3e 自动帮我们打包好 ---\x3e 自动将打包好的文件发送到指定的服务器\n----\x3e 直接访问\n")])])]),n("h3",{attrs:{id:"安装jenkenis环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装jenkenis环境"}},[s._v("#")]),s._v(" 安装jenkenis环境")]),s._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装相关依赖")]),s._v("\nyum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y java\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装jenkenis")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -O /etc/yum.repos.d/jenkins.repo http://pkg.jenkins.io/redhat-stable/jenkins.repo\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" --import http://pkg.jenkins.io/redhat-stable/jenkins.io.key\nyum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y jenkins\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动jenkenis")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" jenkins start\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打开jenkins")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装jenkins服务器ip+:8080")]),s._v("\n\n")])])]),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"custom-block-title"},[s._v("自动部署服务器注意点：")]),s._v(" "),n("ul",[n("li",[s._v("由于自动部署服务器需要对项目进行编译打包, 并且会保存编译打包结果, 所以自动部署服务器是非常消耗性能的\n所以在企业开发中, 一般情况下都是使用一台独立的服务器作为自动部署服务器")]),s._v(" "),n("li",[s._v("如果想使用jenkins实现自动部署, 那么安装好了jenkins之后, 我们还需要安装项目下载/项目编译/项目上传相关插件\n"),n("ul",[n("li",[s._v("jenkins会自动从SVN/GIT下载代码  -- 需要SVN/GIT相关插件\n"),n("ul",[n("li",[s._v("Manager jenkins -> Manager Plugins -> 可选插件 (默认会安装git)")])])]),s._v(" "),n("li",[s._v("jenkins会自动编译打包下载好的项目 -- 需要安装NODEJS\n"),n("ul",[n("li",[s._v("Manager jenkins -> Manager Plugins -> 可选插件 -> Node")]),s._v(" "),n("li",[s._v("系统管理 -> 全局工具配置 -> Node -> 新增Node -> 保存")])])]),s._v(" "),n("li",[s._v("jenkins会自动将编译打包好的文件发送到部署服务器对应的目录中  --需要安装SSH插件\n"),n("ul",[n("li",[s._v("Manager jenkins -> Manager Plugins -> 可选插件 -> Publish over SSH插件")]),s._v(" "),n("li",[s._v("系统管理 -> 系统配置 -> Publish over SSH配置 -> 添加远程服务器配置 IP/用户名/密码/上传目录\n常见问题:")])])])])]),s._v(" "),n("li",[s._v("卡在启动界面不动\n修改 "),n("code",[s._v("/var/lib/jenkins")]),s._v("目录下的"),n("code",[s._v("hudson.model.UpdateCenter.xml")]),s._v("\n将\n"),n("code",[s._v("http://updates.jenkins-ci.org/update-center.json")]),s._v("\n改成\n"),n("code",[s._v("http://mirror.xmission.com/jenkins/updates/update-center.json")])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);